<div class="madpad-container minwidth">
	<section class="new-pad btn btn-1e">
		<a href="#"><img src="/images/sidebar/new@2x.png">New Pad</a>
	</section>
	<div class="left">
		<div class="offset"></div>
		<div class="all-pads">
			<section class="user-pads pad-list pad-hover">
				<h5>Adventjex</h5>
				<ul>
					<a href="#"><li>iOS</li></a>
					<a href="#"><li>Nodejs</li></a>
					<a href="#"><li>Sanjose</li></a>
					<a href="#"><li>Gameofthrones</li></a>
					<a href="#" class="active"><li>Aprcode1</li></a>
					<a href="#"><li>test</li></a>
				</ul>
			</section> <!-- user's pads -->
			<section class="shared-pads pad-list pad-hover">
				<h5>Shared Pads</h5>
				<ul>
					<a href="#"><li>apr</li></a>
					<a href="#"><li>wedding</li></a>
					<a href="#"><li>designux</li></a>
					<a href="#"><li>hiking</li></a>
					<a href="#"><li>feast</li></a>
				</ul>
			</section> <!-- shared pads -->
			<section class="public-pads pad-list pad-hover">
				<h5>Public Pads</h5>
				<ul>
					<a href="#"><li>doge</li></a>
					<a href="#"><li>reddit</li></a>
					<a href="#"><li>bitcoins</li></a>
					<a href="#"><li>facebook</li></a>
					<a href="#"><li>netflix</li></a>
					<a href="#"><li>okay</li></a>
				</ul>
		</section> <!-- public pads -->
		</div>
	</div>

	{{> new_pad}}

	<div class="middle {{#unless pad.chat}}no-chat-fix{{/unless}}">
		<div class="title">
			<div class="pad-name">
				<h2>{{id}} <span>{{#if pad.isTextPad}}pad{{else}}{code pad}{{/if}}</span></h2>
			</div>
			<div class="title-options">
				<a href="#" id="padPublic">PUBLIC</a>
				<a href="#" id="padShared">SHARED</a>
				<a href="#" id="padPrivate">PRIVATE</a>
				{{#if usersRoom}}<div class="icon pad-settings {{#if pad.readAccess}}{{#if pad.writeAccess}}public-icon{{else}}shared-icon{{/if}}{{else}}private-icon{{/if}}"></div>{{/if}}
				<div class="icon {{#if pad.chat}}chaton-icon{{else}}chatoff-icon{{/if}}"></div>
				{{#if usersRoom}}<div class="icon trash-icon"></div>{{/if}}
			</div>
		</div>
		<div class="pad-wrapper">
			{{#if pad.isTextPad}}
				<div id="editor" class="pad-area" placeholder="Start typing here!"></div>
				<textarea class="main" style="display:none;" id="pusherContentEditable"></textarea>
			{{else}}
				{{> code_modes_select}}
				<div id="editor-code" class="pad-area"></div>
			{{/if}}
		</div>
	</div> <!-- main text area -->

	<div class="right" {{#unless pad.chat}}style="display:none"{{/unless}}>
		<div class="chat-title">
			<p><span>chat</span></p>
		</div>
    <div id="messages"></div>

    <div class="submit-wrapper">
	    <div class="submit-area">
		    <form action="" class="madpadChatForm">
		    	<textarea id="m" autocomplete="off" class="message-input" placeholder="Send a message..."></textarea>
		    </form>
	    </div>
    </div>
	</div> <!-- chat -->

</div>
<script>

var id = '{{id}}';
var usersRoom = '{{usersRoom}}';
var isTextPad = '{{pad.isTextPad}}';
var padType = (isTextPad == 'true') ? 'text' : 'code';
var padName = (usersRoom) ? usersRoom + '_' + id : padType + '_' + id;
var username = '{{user.username}}';
var userID = '{{user._id}}';

var padData = {
	type: '{{pad.type}}' || 'text',
}

madpadUserData = {
	facebookID: '{{user.facebookID}}',
	githubID: '{{user.githubID}}',
	facebookDate: new Date('{{user.facebookDate}}'),
	githubDate: new Date('{{user.githubDate}}'),
	facebookName: '{{user.facebookName}}',
	facebookPicture: '{{user.facebookPicture}}',
	githubName: '{{user.githubName}}',
	githubPicture: '{{user.githubPicture}}',
}

var options = {authentication: userID};

madpadSocket = io();
madpadSocket.emit('room', padName);

</script>
<script>
$(document).ready(function(){
	
	var padPrivacy = {
		makePublic: function(){
			madpadSocket.emit('togglePrivacy', {room: padName, type: 'public', write: true, read: true});
		},
		makeShared: function(){
			madpadSocket.emit('togglePrivacy', {room: padName, type: 'shared', write: false, read: true});
		},
		makePrivate: function(){
			madpadSocket.emit('togglePrivacy', {room: padName, type: 'private', write: false, read: false});
		},
		changeToPublicIcon: function(){
			$('.pad-settings').removeClass('private-icon').removeClass('shared-icon').removeClass('public-icon').addClass('public-icon');
		},
		changeToSharedIcon: function(){
			$('.pad-settings').removeClass('private-icon').removeClass('shared-icon').removeClass('public-icon').addClass('shared-icon');
		},
		changeToPrivateIcon: function(){
			$('.pad-settings').removeClass('private-icon').removeClass('shared-icon').removeClass('public-icon').addClass('private-icon');
		}
	}

	$("#padPublic").on("click", function(){
		padPrivacy.makePublic();
		padPrivacy.changeToPublicIcon();
	});
	$("#padShared").on("click", function(){
		padPrivacy.makeShared();
		padPrivacy.changeToSharedIcon();
	});
	$("#padPrivate").on("click", function(){
		padPrivacy.makePrivate();
		padPrivacy.changeToPrivateIcon();
	});

	madpadSocket.on('togglePrivacy', function(whichWay){
		// add user name checking
		if(usersRoom == username) return;
		console.log(whichWay);
		switch(whichWay){
			case 'private':
				padPrivacy.changeToPrivateIcon();
				location.reload(true);
				break;
			case 'shared':
				padPrivacy.changeToSharedIcon();
				break;
			case 'public':
				padPrivacy.changeToPublicIcon();
				// open up writing on pads
				break;
			default:
				break;
		}
	});


});
</script>