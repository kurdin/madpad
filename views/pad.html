<div class="madpad-container minwidth">
	<div class="left">
		<div class="offset"></div>
		<div class="all-pads">
			<section class="user-pads pad-list pad-hover">
				{{#if user.username}}
					<h5>{{user.username}}'s pads</h5>
					<ul>
						{{#each myPads.privatePads}}
							<li class="pad-item">
								{{#if this.favorite}}<span class="favorite"></span>{{/if}}
								<a href="/{{this.url}}">{{strip_name this.url}} </a>
								<span class="pad-heart-x">
									<span class="deleteRecent delete"></span>
								</span>
							</li>
						{{/each}}
					</ul>
				{{/if}}
			</section> <!-- user's pads -->
			<section class="shared-pads pad-list pad-hover">
				<h5>shared pads</h5>
				<ul>
					{{#each myPads.sharedPads}}
						<li class="pad-item">
								{{#if this.favorite}}<span class="favorite"></span>{{/if}}
								<a href="/{{this.url}}">{{strip_name this.url}} </a>
								<span class="pad-heart-x">
									<span class="deleteRecent delete"></span>
								</span>
							</li>
					{{/each}}
				</ul>
			</section> <!-- shared pads -->
			<section class="public-pads pad-list pad-hover">
				<h5>public pads</h5>
				<ul>
					{{#each myPads.publicPads}}
						<li class="pad-item">
								{{#if this.favorite}}<span class="favorite"></span>{{/if}}
								<a href="/{{this.url}}">{{strip_name this.url}} </a>
								<span class="pad-heart-x">
									<span class="deleteRecent delete"></span>
								</span>
							</li>
					{{/each}}
				</ul>
		</section> <!-- public pads -->
		</div>
	</div>

	{{> new_pad}}

	<div class="middle {{#unless pad.chat}}no-chat-fix{{/unless}}">
		<div class="title">
			<div class="pad-name">
				<h2>{{id}} <span>{{#if pad.isTextPad}}pad{{else}}{code pad}{{/if}}</span></h2>
			</div>
			<div class="title-options">	
				<div class="icon new-icon"></div>
				<div id="heartFavoriteIcon" class="icon heart-icon"></div>			
				<div class="icon {{#if pad.chat}}chaton-icon{{else}}chatoff-icon{{/if}}"></div>
				{{#if usersRoom}}<div class="icon trash-icon"></div>{{/if}}
			</div>
			<!-- change settings icon -->
			{{#if usersRoom}}
				<div class="share-settings-icon">
					<div class="icon pad-settings 
						{{#if pad.readAccess}}{{#if pad.writeAccess}}public-icon{{else}}shared-icon{{/if}}{{else}}private-icon{{/if}}">
					</div>
					<span id="settings-text">
						{{#if pad.readAccess}}{{#if pad.writeAccess}}Editable by Anyone{{else}}Viewable by Anyone{{/if}}{{else}}Completely Private{{/if}}
					</span>
				</div>
			{{/if}}	<!-- end change settings icon -->		
		</div>
		<div class="pad-wrapper">
			{{#if pad.isTextPad}}
				<div id="editor" class="pad-area" placeholder="Start typing here!"></div>
				<textarea class="main" style="display:none;" id="pusherContentEditable"></textarea>
			{{else}}
				{{> code_modes_select}}
				<div id="editor-code" class="pad-area"></div>
			{{/if}}
		</div>
	</div> <!-- main text area -->

	<div class="right" {{#unless pad.chat}}style="display:none"{{/unless}}>
		<div class="chat-title">
			<p><span>chat</span></p>
		</div>
    <div id="messages"></div>

    <div class="submit-wrapper">
	    <div class="submit-area">
		    <form action="" class="madpadChatForm">
		    	<textarea id="m" autocomplete="off" class="message-input" placeholder="Send a message..."></textarea>
		    </form>
	    </div>
    </div>
	</div> <!-- chat -->

</div>
<script>

var id = '{{id}}';
var usersRoom = '{{usersRoom}}';
var isTextPad = '{{pad.isTextPad}}';
var padType = (isTextPad == 'true') ? 'text' : 'code';
var padName = (usersRoom) ? usersRoom + '_' + id : padType + '_' + id;
var username = '{{user.username}}';
var userID = '{{user._id}}';
var isOwner = (usersRoom == username) ? true : false;

var padData = {
	type: '{{pad.type}}' || 'text',
}

var padReadAccess = '{{pad.readAccess}}';
var padWriteAccess = '{{pad.writeAccess}}';
var padPrivacyStatus = 'private';
if(padReadAccess) padPrivacyStatus = 'shared';
if(padWriteAccess) padPrivacyStatus = 'public';

madpadUserData = {
	facebookID: '{{user.facebookID}}',
	githubID: '{{user.githubID}}',
	facebookDate: new Date('{{user.facebookDate}}'),
	githubDate: new Date('{{user.githubDate}}'),
	facebookName: '{{user.facebookName}}',
	facebookPicture: '{{user.facebookPicture}}',
	githubName: '{{user.githubName}}',
	githubPicture: '{{user.githubPicture}}',
}

var options = {authentication: userID};

madpadSocket = io();
madpadSocket.emit('room', padName);

// var deleteRecent = {
// 	remove: function(){
// 		$('.deleteRecent').on('click', function(e){
// 			if (!e) e = window.event;
// 			e.stopPropagation();
// 			var closestPad = $(this).siblings('a');
// 			// closestPad.remove();
// 			console.log(closestPad);
// 			// $(this).remove();
			
// 			console.log(closestPad.attr('href'));

// 		});
// 	},
// 	run: function(){
// 		this.remove();
// 	}
// }

// deleteRecent.run();

</script>
{{> heart_functions}}
